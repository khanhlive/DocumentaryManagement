@using DocumentaryManagement.Web.Host.Reports
@model DevExpress.XtraReports.UI.XtraReport

@{
    ViewData["Title"] = "Viewer";
    Layout = "~/Views/Shared/_LayoutReport.cshtml";
    bool autoPrint = false;
    if (ViewBag.autoPrint)
    {
        autoPrint = (bool)ViewBag.autoPrint;
    }
    if (Model != null)
    {
        Model.RequestParameters = false;
    }
}

@section styles{
    <link href="~/node_modules/jquery-ui-dist/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/node_modules/devextreme/dist/css/dx.common.css" rel="stylesheet" />
    <link href="~/node_modules/devextreme/dist/css/dx.light.css" rel="stylesheet" />
    <link href="~/node_modules/@@devexpress/analytics-core/dist/css/dx-analytics.common.css" rel="stylesheet" />
    <link href="~/node_modules/@@devexpress/analytics-core/dist/css/dx-analytics.light.css" rel="stylesheet" />
    <link href="~/node_modules/devexpress-reporting/dist/css/dx-webdocumentviewer.css" rel="stylesheet" />
}

@section scripts{

    <!-- 3rd-party dependencies -->
    <script src="~/node_modules/jquery/dist/jquery.js"></script>
    <script src="~/node_modules/jquery-ui-dist/jquery-ui.js"></script>
    <script src="~/node_modules/knockout/build/output/knockout-latest.js"></script>
    <script src="~/node_modules/cldrjs/dist/cldr.js"></script>
    <script src="~/node_modules/cldrjs/dist/cldr/event.js"></script>
    <script src="~/node_modules/cldrjs/dist/cldr/supplemental.js"></script>
    <script src="~/node_modules/cldrjs/dist/cldr/unresolved.js"></script>
    <script src="~/node_modules/globalize/dist/globalize.js"></script>
    <script src="~/node_modules/globalize/dist/globalize/message.js"></script>
    <script src="~/node_modules/globalize/dist/globalize/number.js"></script>
    <script src="~/node_modules/globalize/dist/globalize/currency.js"></script>
    <script src="~/node_modules/globalize/dist/globalize/date.js"></script>

    <script src="~/node_modules/devextreme/dist/js/dx.all.js"></script>
    <script src="~/node_modules/@@devexpress/analytics-core/dist/js/dx-analytics-core.min.js"></script>
    <script src="~/node_modules/devexpress-reporting/dist/js/dx-webdocumentviewer.min.js"></script>
    <script>
        function collapsed(s, e) {
            var preview = s.GetPreviewModel();
            debugger
            preview.tabPanel.collapsed(true);
        }
    </script>
    @if (autoPrint)
    {
        <script>
            function onDocumentReady(s, e) {
                console.log("onDocumentReady: ", s, e);
                collapsed(s, e);
                setTimeout(function () {
                    s.previewModel.Print();
                }, 100)
            }
        </script>
    }
}
@Html.DevExpress().WebDocumentViewer("DocumentViewer").Height("1000px").Bind(Model).ClientSideEvents(config =>
{
    if (autoPrint) {
        config.DocumentReady("onDocumentReady");
    }
})

